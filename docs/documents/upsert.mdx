---
title: "Upsert documents"
---

TopK documents are JSON-like objects containing key-value pairs.

## Upsert function

To upsert documents, pass a list of documents to the `upsert()` function:

<CodeGroup>

```python Python
client.collection("books").upsert(
    [
        {
            "_id": "book-1",
            "title": "The Great Gatsby",
            "published_year": 1925,
            "title_embedding": [0.12, 0.67, 0.82, 0.53, ...]
        },
        {
            "_id": "book-2",
            "title": "To Kill a Mockingbird",
            "published_year": 1960,
            "title_embedding": [0.42, 0.53, 0.65, 0.33, ...]
        },
        {
            "_id": "book-3",
            "title": "1984",
            "published_year": 1949,
            "title_embedding": [0.59, 0.33, 0.71, 0.61, ...]
        }
    ]
)
```


```typescript Javascript
await client.collection("books").upsert([
  {
    _id: "book-1",
    title: "The Great Gatsby",
    published_year: 1925,
    title_embedding: [0.12, 0.67, 0.82, 0.53],
  },
  {
    _id: "book-2",
    title: "To Kill a Mockingbird",
    published_year: 1960,
    title_embedding: [0.42, 0.53, 0.65, 0.33],
  },
  {
    _id: "book-3",
    title: "1984",
    published_year: 1949,
    title_embedding: [0.59, 0.33, 0.71, 0.61],
  },
]);
```

</CodeGroup>

- Every document must have a **string** `_id` field.
- If a document with the specified `_id` doesn't exist, a new document will be **inserted**.
- If a document with the same `_id` already exists, the existing document will be **replaced** with the new one.

<Note>
  The `upsert()` function does not perform a _partial update_ or _merge_ - the entire document is being replaced.
</Note>

<Warning>
  Each document you send is serialized as a Protocol Buffers (protobuf) message. The encoded size of that message must be **128KB or smaller**.
</Warning>

## Supported types

TopK documents are a flat structure of key-value pairs.

The following value types are supported:

| Type                  | Python Type   | JavaScript Type | Helper Function                                                |
| --------------------- | ------------- | --------------- | -------------------------------------------------------------- |
| **String**            | `str`         | `string`        | -                                                              |
| **Integer**           | `int`         | `number`        | -                                                              |
| **Float**             | `float`       | `number`        | -                                                              |
| **Boolean**           | `bool`        | `boolean`       | -                                                              |
| **String list**       | `list[str]`   | `string[]`      | [`string_list()`](./data-constructors#string-list)             |
| **F32 list**          | `list[float]` | `number[]`      | [`f32_list()`](./data-constructors#f32-list)                   |
| **F64 list**          | _use helper_  | _use helper_    | [`f64_list()`](./data-constructors#f64-list)                   |
| **I32 list**          | _use helper_  | _use helper_    | [`i32_list()`](./data-constructors#i32-list)                   |
| **I64 list**          | _use helper_  | _use helper_    | [`i64_list()`](./data-constructors#i64-list)                   |
| **U32 list**          | _use helper_  | _use helper_    | [`u32_list()`](./data-constructors#u32-list)                   |
| **F32 vector**        | `list[float]` | `number[]`      | [`f32_vector()`](./data-constructors#f32-vector)               |
| **U8 vector**         | _use helper_  | _use helper_    | [`u8_vector()`](./data-constructors#u8-vector)                 |
| **I8 vector**         | _use helper_  | _use helper_    | [`i8_vector()`](./data-constructors#i8-vector)                 |
| **Binary vector**     | _use helper_  | _use helper_    | [`binary_vector()`](./data-constructors#binary-vector)         |
| **F32 sparse vector** | _use helper_  | _use helper_    | [`f32_sparse_vector()`](./data-constructors#f32-sparse-vector) |
| **U8 sparse vector**  | _use helper_  | _use helper_    | [`u8_sparse_vector()`](./data-constructors#u8-sparse-vector)   |
| **Bytes**             | _use helper_  | _use helper_    | [`bytes()`](./data-constructors#bytes)                         |

## Data constructors

See the [Data constructors](./data-constructors) page for details on how to use complex data types in TopK.
